# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VG-v2jr2e4ywmkMLCRIhRg290YNzoCCy
"""

import pandas as pd
import seaborn as sns
import google.colab as files

"""Задача 1. Загрузите данные о численности студентов
образовательных организаций с сайта министерства
образования. Выведите их на экран.

!!! Файл gh0ovqakv5u5srnqutux61mjhx1ilr35.csv загружен непосредственно в Colab !!!!
"""

df = pd.read_csv('gh0ovqakv5u5srnqutux61mjhx1ilr35.csv', sep=';', encoding='cp1251')
df

"""Задача 2. Выведите те субъекты, в которых
количество студентов очной формы образования
больше 50000 человек.
"""

df[df['Численность студентов, очная форма, человек'] > 50000]

df = df[df['Численность студентов, очная форма, человек'].between(50000,150000)]  
df

df = pd.DataFrame(df, columns = ['Субъект РФ','Численность студентов, очная форма, человек','Год формирования сведений'])
df

"""Сделаем выборку строк, в которых отсутствует слово 'округ'

Подзадача: Создадим маску: объект, фиксирующий наличие в строках слова 'округ'
"""

msk = df['Субъект РФ'].str.contains('округ')

df = df.drop(df[msk].index)
df

"""Задача 3. Составьте столбчатую диаграмму для
данных, полученных в задаче 2.
Среди имеющихся субъектов, найдите субъекты с
максимальным и минимальным количеством
студентов на очной-форме обучения.
"""

minvalue = df['Численность студентов, очная форма, человек'].min()
minvalue

"""Выводим строку, содержащую минимальную численность студентов  minvalue"""

df[df['Численность студентов, очная форма, человек'] == minvalue]

plot = sns.barplot(df, x = 'Субъект РФ', y = 'Численность студентов, очная форма, человек')
plot.set_xticklabels(labels = df['Субъект РФ'], rotation = 90)

"""Задача 4. Сохраните полученные данные в файл с
расширением .csv. Скачайте его.
"""

df.to_csv('data2021.csv')
files.files.download('data2021.csv')

"""Загружаем файл из списка файлов проекта (вкладка Файлы, слева)"""

df_2021 = pd.read_csv('data_20201229_structure_20201229_10.csv', sep=';', encoding='cp1251')
df_2021

"""Выборка строк-столбцов в таблице"""

df_2021.iloc[:,10:17]